<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">

<!-- Mirrored from qedcode.com/content/knockout-js-and-mvc-model-binding by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 12:22:19 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Knockout JS and MVC Model Binding | Q.E.D. Code</title>
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="http://qedcode.com/misc/favicon.ico" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="http://qedcode.com/modules/book/book.css?2" />
<link type="text/css" rel="stylesheet" media="all" href="http://qedcode.com/modules/node/node.css?2" />
<link type="text/css" rel="stylesheet" media="all" href="http://qedcode.com/modules/system/defaults.css?2" />
<link type="text/css" rel="stylesheet" media="all" href="http://qedcode.com/modules/system/system.css?2" />
<link type="text/css" rel="stylesheet" media="all" href="http://qedcode.com/modules/system/system-menus.css?2" />
<link type="text/css" rel="stylesheet" media="all" href="http://qedcode.com/modules/user/user.css?2" />
<link type="text/css" rel="stylesheet" media="all" href="http://qedcode.com/sites/all/modules/mollom/mollom.css?2" />
<link type="text/css" rel="stylesheet" media="all" href="http://qedcode.com/sites/all/modules/views/css/views.css?2" />
<link type="text/css" rel="stylesheet" media="all" href="http://qedcode.com/modules/comment/comment.css?2" />
<link type="text/css" rel="stylesheet" media="all" href="http://qedcode.com/themes/theme073/style.css?2" />
  <script type="text/javascript" src="http://qedcode.com/misc/jquery.js?2"></script>
<script type="text/javascript" src="http://qedcode.com/misc/drupal.js?2"></script>
<script type="text/javascript" src="http://qedcode.com/sites/all/modules/google_analytics/googleanalytics.js?2"></script>
<script type="text/javascript" src="http://qedcode.com/sites/all/modules/mollom/mollom.js?2"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, { "basePath": "/", "googleanalytics": { "trackOutbound": 1, "trackMailto": 1, "trackDownload": 1, "trackDownloadExtensions": "7z|aac|arc|arj|asf|asx|avi|bin|csv|doc|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls|xml|z|zip" } });
//--><!]]>
</script>
  
</head>
  
<body>
    <table id="main">
        <tr>
            <td width="100%" class="header">
            	<div class="top-left">
                	<div class="top-right">
                    	<table width="100%">
                            <tr>
                                <td width="100%" style="height:195px;">
                                    <table width="100%">
                                        <tr>
                                            <td width="">
                                                                                                    <a href="../index.html" title="Home"><img src="http://qedcode.com/themes/theme073/images/logo.png" alt="Home" border="0" class="logo" /></a><br />
                                                                                                                                                
                                                                                            </td>
                                            <td width="270">
                                                <div class="search-box">
                                                                                                    </div>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td width="100%" style="height:54px;">
                                                                            <div class="pr-menu">
                                            <ul class="links primary-links"><li class="menu-227 first"><a href="../node.html" title="">Latest Article</a></li>
<li class="menu-339"><a href="../podcast.html" title="Q.E.D. Code Podcast">Podcast</a></li>
<li class="menu-219"><a href="../theory.html" title="">Theory</a></li>
<li class="menu-220"><a href="../practice.html" title="">Practice</a></li>
<li class="menu-221 last"><a href="../speaking.html" title="">Speaking</a></li>
</ul>                                            <br class="clear" />
                                        </div>
                                                                    </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </td>
        </tr>
        <tr>
            <td width="100%">
                <table width="100%" >
                    <tr>
                        <td width="189">
                            <div class="left2">
                                                                    <table width="100%">
                                      <tr>
                                        <td width="100%">
                                            <div class="block block-block" id="block-block-2">
	<div class="block-bot">
    	<div class="block-top">
        	<div class="block-indent">
                <div class="title">
                    <h3>About me</h3>
                </div>
                <div class="content"><div style="margin: 15px;">
<p style="margin-bottom: 7px;">Michael L Perry</p>
<p><a href="http://improvingenterprises.com/"><img src="../images/IE-Logo.png" width="145" alt="Improving Enterprises" /></a></p>
<p style="margin-bottom: 15px;">Principal Consultant</p>
<p><a href="http://twitter.com/michaellperry">@michaellperry</a></p>
</div>
</div>
            </div>
        </div>
    </div>
</div><div class="block block-user" id="block-user-0">
	<div class="block-bot">
    	<div class="block-top">
        	<div class="block-indent">
                <div class="title">
                    <h3>User login</h3>
                </div>
                <div class="content"><form action="http://qedcode.com/content/knockout-js-and-mvc-model-binding?destination=node%2F89"  accept-charset="UTF-8" method="post" id="user-login-form">
<div><div class="form-item" id="edit-name-wrapper">
 <label for="edit-name">Username: <span class="form-required" title="This field is required.">*</span></label>
 <input type="text" maxlength="60" name="name" id="edit-name" size="15" value="" class="form-text required" />
</div>
<div class="form-item" id="edit-pass-wrapper">
 <label for="edit-pass">Password: <span class="form-required" title="This field is required.">*</span></label>
 <input type="password" name="pass" id="edit-pass"  maxlength="60"  size="15"  class="form-text required" />
</div>
<input type="submit" name="op" id="edit-submit" value="Log in"  class="form-submit" />
<div class="item-list"><ul><li class="first last"><a href="../user/password.html" title="Request new password via e-mail.">Request new password</a></li>
</ul></div><input type="hidden" name="form_build_id" id="form-30caa79d68a19206bea71f07c3230582" value="form-30caa79d68a19206bea71f07c3230582"  />
<input type="hidden" name="form_id" id="edit-user-login-block" value="user_login_block"  />

</div></form>
</div>
            </div>
        </div>
    </div>
</div>                                        </td>
                                      </tr>
                                    </table>
                                                            </div>
                        </td>
                        <td width="0">
                            <div class="right2">
                                                            </div>
                        </td>
                        <td width="" class="cont-row">
                            <div class="border-left">
                                <div class="border-right">
                                    <div class="border-bot">
                                        <div class="border-top">
                                            <div class="corner-bot-left">
                                                <div class="corner-bot-right">
                                                    <div class="corner-top-left">
                                                        <div class="corner-top-right">
                                                            <div class="cent">
                                                                                                                                                                                                
                                                                                                                        
                                                                <h2>Knockout JS and MVC Model Binding</h2>
                                                                                                                                                                                                                                                                 
                                                                                                                    
                                                                                                                    
                                                              <!-- start main content -->
                                                            <div class="node">
	    <div class="taxonomy"></div>
  
    <div class="content"><p>Source code for this post is at <a href="https://github.com/MichaelLPerry/BuyMoreStuff">https://github.com/MichaelLPerry/BuyMoreStuff</a>.</p>
<p>Knockout is a great way to make interactive web pages using data binding and dependency tracking. Most of the uses of Knockout that I’ve seen use AJAX to send data to a RESTful JSON endpoint. But if you are using ASP.NET MVC, you don’t have to write another service if you don’t want to. You can take advantage of the powerful model binding that is built into the platform.</p>
<h3>Interaction with observable arrays</h3>
<p>Say you are building a shopping cart web page. You want your users to manage items in their cart all in the client, with no post-backs. Knockout is fantastic at this style of interaction. Just create a ko.observableArray in your view model, and add all of the cart lines to that array.</p>
<pre class="code"><span style="color: blue">var </span>ViewModel = <span style="color: blue">function </span>() {
    <span style="color: blue">this</span>.lines = ko.observableArray([
    <span style="background: yellow">@</span><span style="color: blue">if </span>(Model != <span style="color: blue">null </span>&amp;&amp; Model.Cart != <span style="color: blue">null </span>&amp;&amp; Model.Cart.Lines != <span style="color: blue">null</span>)
    {
        <span style="color: blue">foreach </span>(<span style="color: blue">var </span>line <span style="color: blue">in </span>Model.Cart.Lines)
        {
            <span style="color: blue">var </span>product = Model.GetProductById(line.ProductId);
            <span style="color: blue">if </span>(product != <span style="color: blue">null</span>)
            {
                <span style="background: yellow">@:</span><span style="color: blue">new </span>Line(<span style="color: blue">this</span>, <span style="background: yellow">@</span>line.ProductId, <span style="color: maroon">&quot;</span><span style="background: yellow; color: maroon">@</span>product.Name<span style="color: maroon">&quot;</span>, <span style="background: yellow">@</span>product.UnitPrice, <span style="background: yellow">@</span>line.Quantity),
            }
        }
    }
    ]);
};</pre><p>The loop is generating JavaScript for all of the items already in the cart. So when the browser fetches the page, it is already fully populated. There is no second call to get the cart data.</p>
<p>Each of the lines in the array has an observable quantity, in addition to some immutable properties.</p>
<pre class="code"><span style="color: blue">var </span>Line = <span style="color: blue">function </span>(container, productId, productName, unitPrice, quantity) {
    <span style="color: blue">this</span>.productId = productId;
    <span style="color: blue">this</span>.productName = productName;
    <span style="color: blue">this</span>.unitPrice = unitPrice;

    <span style="color: blue">this</span>.quantity = ko.observable(quantity);

    <span style="color: blue">this</span>.remove = <span style="color: blue">function</span>() {
        container.lines.remove(<span style="color: blue">this</span>);
    }.bind(<span style="color: blue">this</span>);
}</pre><p>To data bind these lines to a table, just use Knockout’s data-bind attribute.</p>
<pre class="code">        <span style="color: blue">&lt;</span><span style="color: maroon">table</span><span style="color: blue">&gt;

        &lt;</span><span style="color: maroon">thead</span><span style="color: blue">&gt;
        &lt;</span><span style="color: maroon">tr</span><span style="color: blue">&gt;
        &lt;</span><span style="color: maroon">th</span><span style="color: blue">&gt;</span>Product<span style="color: blue">&lt;/</span><span style="color: maroon">th</span><span style="color: blue">&gt;
        &lt;</span><span style="color: maroon">th</span><span style="color: blue">&gt;</span>Quantity<span style="color: blue">&lt;/</span><span style="color: maroon">th</span><span style="color: blue">&gt;
        &lt;</span><span style="color: maroon">th</span><span style="color: blue">&gt;</span>Price<span style="color: blue">&lt;/</span><span style="color: maroon">th</span><span style="color: blue">&gt;
        &lt;</span><span style="color: maroon">th</span><span style="color: blue">&gt;</span><span style="color: red">&amp;nbsp;</span><span style="color: blue">&lt;/</span><span style="color: maroon">th</span><span style="color: blue">&gt;
        &lt;/</span><span style="color: maroon">tr</span><span style="color: blue">&gt;
        &lt;/</span><span style="color: maroon">thead</span><span style="color: blue">&gt;

        &lt;</span><span style="color: maroon">tbody </span><span style="color: red">data-bind</span><span style="color: blue">=&quot;foreach: lines&quot;&gt;
        &lt;</span><span style="color: maroon">tr</span><span style="color: blue">&gt;
        &lt;</span><span style="color: maroon">td</span><span style="color: blue">&gt;
            &lt;</span><span style="color: maroon">input </span><span style="color: red">type</span><span style="color: blue">=&quot;hidden&quot; </span><span style="color: red">data-bind</span><span style="color: blue">=&quot;value: productId&quot; /&gt;
            &lt;</span><span style="color: maroon">span </span><span style="color: red">data-bind</span><span style="color: blue">=&quot;text: productName&quot;&gt;&lt;/</span><span style="color: maroon">span</span><span style="color: blue">&gt;
        &lt;/</span><span style="color: maroon">td</span><span style="color: blue">&gt;
        &lt;</span><span style="color: maroon">td</span><span style="color: blue">&gt;&lt;</span><span style="color: maroon">input </span><span style="color: red">type</span><span style="color: blue">=&quot;text&quot; </span><span style="color: red">data-bind</span><span style="color: blue">=&quot;value: quantity&quot; /&gt;&lt;/</span><span style="color: maroon">td</span><span style="color: blue">&gt;
        &lt;</span><span style="color: maroon">td </span><span style="color: red">data-bind</span><span style="color: blue">=&quot;text: unitPrice * quantity()&quot;&gt;&lt;/</span><span style="color: maroon">td</span><span style="color: blue">&gt;
        &lt;</span><span style="color: maroon">td</span><span style="color: blue">&gt;&lt;</span><span style="color: maroon">button </span><span style="color: red">type</span><span style="color: blue">=&quot;button&quot; </span><span style="color: red">data-bind</span><span style="color: blue">=&quot;click: remove&quot;&gt;</span>-<span style="color: blue">&lt;/</span><span style="color: maroon">button</span><span style="color: blue">&gt;&lt;/</span><span style="color: maroon">td</span><span style="color: blue">&gt;
        &lt;/</span><span style="color: maroon">tr</span><span style="color: blue">&gt;
        &lt;/</span><span style="color: maroon">tbody</span><span style="color: blue">&gt;

        &lt;/</span><span style="color: maroon">table</span><span style="color: blue">&gt;

</span></pre><p>Notice the button data binding to the remove function so that the user can remove items from the cart.</p>
<h3>Model binding</h3>
<p>Now we need to get the modified cart data back on submit. Here’s where the model binder comes in. The MVC model binder looks for names on input fields to determine what properties to set. When the name refers to an element of a collection, the model binder creates an object and inserts it into the collection. We can use the Knockout “attr” syntax to set the name attribute of the inputs.</p>
<pre class="code"><span style="color: blue">&lt;</span><span style="color: maroon">input </span><span style="color: red">type</span><span style="color: blue">=&quot;hidden&quot; </span><span style="color: red">data-bind</span><span style="color: blue">=&quot;value: productId, attr: {name: 'Cart.Lines[' + $index() + '].ProductId'}&quot; /&gt;
</span></pre><pre class="code"><span style="color: blue">&lt;</span><span style="color: maroon">input </span><span style="color: red">type</span><span style="color: blue">=&quot;text&quot; </span><span style="color: red">data-bind</span><span style="color: blue">=&quot;value: quantity, attr: {name: 'Cart.Lines[' + $index() + '].Quantity'}&quot; /&gt;
</span></pre><p>Now when you submit this form, the MVC model binder will create a Cart object containing all of the items that the user managed on their client. This was all done through the standard MVC Razor view engine and model binder, with no additional AJAX calls. </p>
</div>
    <br />
        	<div class="links-align">
            <div class="bg-links">
                <div class="links-left">
                    <div class="links-right">
                        <div class="links"><ul class="links inline"><li class="blog_usernames_blog first"><a href="../blogs/michael-l-perry.html" title="Read Michael L Perry&#039;s latest blog entries.">Michael L Perry&#039;s blog</a></li>
<li class="comment_add last"><a href="http://qedcode.com/comment/reply/89#comment-form" title="Share your thoughts and opinions related to this posting.">Add new comment</a></li>
</ul></div>
                    </div>
                </div>
            </div>
        </div>
	    <br class="clear" />    
    </div><div id="comments">
  <a id="comment-93"></a>
<div class="comment comment-published">
    <h3 class="title"><a href="knockout-js-and-mvc-model-binding.html#comment-93" class="active">Knockout MVC</a></h3>
  <div class="submitted">Submitted by <a href="http://www.megc.pt/" rel="nofollow">Márcio Cardoso</a> (not verified) on Thu, 03/13/2014 - 11:43.</div>
  <div class="content">
    <p>Hello,</p>
<p>I'm a bit confused, when I have a Model that dont have sub properties like yours (Cart.Lines) but instead I have a Model that is the Lines it self..</p>
<p>In the:</p>
<p><input type="hidden" data-bind="value: productId, attr: {name: 'Cart.Lines[' + $index() + '].ProductId'}" /></p>
<p>I have to put Model on the attr: {name: 'Model[' + $index() + '].ProductId'}</p>
<p>or I have to put nothing.. like:</p>
<p>{name: '[' + $index() + '].ProductId'}</p>
<p>???</p>
<p>Thanks in advance.<br />
Márcio</p>
      </div>
  <!-- BEGIN: links -->
  <div class="links"><ul class="links"><li class="comment_reply first last"><a href="http://qedcode.com/comment/reply/89/93">reply</a></li>
</ul></div>
  <!-- END: links -->
</div>
</div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
    <div id="footer">
    	<div class="foot">
        	                <span><a rel="license" href="http://creativecommons.org/licenses/by/3.0/us/"><img alt="Creative Commons License" src="../../licensebuttons.net/l/by/3.0/us/88x31.png" /></a><br /><span dc="http://purl.org/dc/elements/1.1/" href="http://purl.org/dc/dcmitype/Text" property="title" rel="type">Q.E.D. Code</span> by <a cc="http://creativecommons.org/ns#" href="../index.html" property="attributionName" rel="attributionURL">Michael L Perry</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/3.0/us/">Creative Commons Attribution 3.0 United States License</a>.</span>
                    </div>
    </div>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
var _gaq = _gaq || [];_gaq.push(["_setAccount", "UA-389401-7"]);_gaq.push(["_trackPageview"]);(function() {var ga = document.createElement("script");ga.type = "text/javascript";ga.async = true;ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";var s = document.getElementsByTagName("script")[0];s.parentNode.insertBefore(ga, s);})();
//--><!]]>
</script>
</body>

<!-- Mirrored from qedcode.com/content/knockout-js-and-mvc-model-binding by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 12:22:19 GMT -->
</html>
